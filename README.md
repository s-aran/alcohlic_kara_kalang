# アル中カラカラ言語

アル中カラカラことwawawa氏の作品をモチーフにした難解プログラミング言語 (esolang) とその処理系かも

## 特徴

- 命令セット以外の文字列はすべて無視（コメント扱い）するかも
- スタック, アキュームレーター (`8bit`: 0-255), ジャンプテーブルと比較結果フラグを一つずつ持つかも
- 即値は `0` のみでインクリメントまたはデクリメントで値を作るかも
  - オーバーフローが発生する場合は上位ビットは切捨てるかも（ラップ処理かも）
- 比較結果フラグに基づくラベルジャンプができるかも
- 文字出力, 数値出力ができるかも
- メモリーの状態を表示するデバッグ命令を用意しているかも

## サンプルコード

```
スペシャルな言語を作ってみたかも
アル中向け!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!かも

ハイボール!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!かも
* 角ハイ!!!!!!!!かも
* 炭酸水!!!!!!かも
* 氷???かも
* ポッカレモン????????????????????????かも

アル中パウダー!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!かも
* S&B粉からし!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!かも
* S&B粉わさび???かも。そうじゃないかも
* おばあちゃん???????かも
* シャア専用?????????????????????????????かも

アル中ファイヤー!あっづいいいいい
おいしーーーーー
でぎだ
アル中カラカラ～
ぷはー
アル中ステップ!
ただ読みづらい言語になりますた。ご清聴ありがとうございました。またね！
```

### 実行結果

```console
Hello World!
```

<details>

<summary>詳説</summary>

> スペシャルな言語を作ってみたかも

- 「かも」でアキュームレーターの初期値 `0` をスタックに PUSH してるかも
  - NULL文字 (`\0`) として機能するかも

> アル中向け!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!かも

- インクリメントを33回行って `'!'` (33 = 0x21) を作って PUSH するかも

> ハイボール!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!かも

- PUSH してもアキュームレーターの値は保持するのでインクリメントを67回行って `'d'` (100 = 0x63) を作って PUSH するかも

> - 角ハイ!!!!!!!!かも

- 同様にインクリメントを8回行って `'l'` (108 = 0x6C) を作って PUSH するかも

> - 炭酸水!!!!!!かも

- 同様にインクリメントを6回行って `'r'` (114 = 0x72) を作って PUSH するかも

> - 氷???かも

- 同様にデクリメントを3回行って `'o'` (111 = 0x6F) を作って PUSH するかも

> - ポッカレモン????????????????????????かも

- 同様にデクリメントを24回行って `'W'` (87 = 0x57) を作って PUSH するかも

> アル中パウダー!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!かも

- 「アル中」でアキュームレーターをリセットしてインクリメントを32回行って `' '` (32 = 0x20) を作って PUSH するかも

> - S&B粉からし!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!かも

- アキュームレーターの値にインクリメントを79回行って `'o'` (111 = 0x6F) を作って PUSH するかも

> - S&B粉わさび???かも。そうじゃないかも

- 同様にデクリメントを3回行って `'l'` (108 = 0x6C) を作って PUSH するかも
- さらに PUSH して同一文字を表現しているかも

> - おばあちゃん???????かも

- 同様にデクリメントを7回行って `'e'` (101 = 0x65) を作って PUSH するかも

> - シャア専用?????????????????????????????かも

- 同様にデクリメントを29回行って `'H'` (72 = 0x48) を作って PUSH するかも

> アル中ファイヤー!あっづいいいいい

- アキュームレーターの値をリセット後にインクリメントして `1` にするかも
  - 「あっづい」でアキュームレーターの値をキー，現在のプログラムカウンター (PC) を値としてジャンプテーブルに登録するかも

> おいしーーーーー

- POP してるかも

> でぎだ

- アキュームレーターの値のASCII文字として画面出力

> アル中カラカラ～

- アキュームレーターのリセットしかしてないかも

> ぷはー

- アキュームレーターの値とスタックのトップが一致するかを判定するかも
  - NULL文字 (`\0`) の出現判定かも

> アル中ステップ!

- アキュームレーターの値をリセット後にインクリメントして `1` にするかも
  - ジャンプテーブルのキーを指定しているかも

> ただ読みづらい言語になりますた。ご清聴ありがとうございました。またね！

- 「またね」で比較結果フラグが `false` ならジャンプするかも
  - NULL文字 (`\0`) が出現するまで文字を表示するかも
- 最後のインクリメントは装飾用で処理上の意味はないかも！

</details>

## 必要環境

- Rust
- Cargo

## ビルド

```bash
cargo build --release
```

## 実行

```bash
cargo run -- <source-file>
```

例:

```bash
cargo run -- hello.bsm
```

## 命令セット

| ニーモニック                          | 動作                                                                      |
| ------------------------------------- | ------------------------------------------------------------------------- |
| アル中                                | アキュームレーターを`0`にする                                             |
| ！ / !                                | アキュームレーターを1増やす（ラップあり）                                 |
| ？ / ?                                | アキュームレーターを1減らす（ラップあり）                                 |
| かも                                  | アキュームレーターをスタックに積む                                        |
| おいしー                              | スタック先頭を取り出してアキュームレーターへ（空なら`0`）                 |
| あつい / あっつい / あづい / あっづい | 現在PCを「キー=アキュームレーター値」のラベルとして登録                   |
| まじぇまじぇ                          | スタック上位2要素を入れ替える（内部でpush/popを利用）                     |
| ぷはー / ぷっはー                     | 比較フラグを`accumulator == stack_top`に設定（空スタック時`stack_top=0`） |
| ふう                                  | 比較フラグが`true`のとき、アキュームレーター値に対応するラベルへジャンプ  |
| またね                                | 比較フラグが`false`のとき、アキュームレーター値に対応するラベルへジャンプ |
| できた / でぎだ                       | アキュームレーターをASCII文字として出力                                   |
| b / ｂ                                | アキュームレーターを10進数で出力                                          |
| デバッグ                              | VM内部状態を表示                                                          |

## ライセンス

MIT
